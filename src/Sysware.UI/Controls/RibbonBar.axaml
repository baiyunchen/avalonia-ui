<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Sysware.UI.ViewModels"
             xmlns:svg="clr-namespace:Avalonia.Svg.Skia;assembly=Avalonia.Svg.Skia"
             x:Class="Sysware.UI.Controls.RibbonBar"
             x:DataType="vm:MainWindowViewModel">

    <UserControl.Styles>
        <!-- Ribbon Tab Button Style -->
        <Style Selector="Button.ribbon-tab">
            <Setter Property="Background" Value="#E1E1E1"/>
            <Setter Property="BorderBrush" Value="#ACACAC"/>
            <Setter Property="BorderThickness" Value="1,1,1,0"/>
            <Setter Property="Padding" Value="20,8,20,8"/>
            <Setter Property="Margin" Value="0,0,2,0"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="CornerRadius" Value="3,3,0,0"/>
        </Style>
        
        <Style Selector="Button.ribbon-tab:pointerover">
            <Setter Property="Background" Value="#F0F0F0"/>
        </Style>
        
        <Style Selector="Button.ribbon-tab.active">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#ACACAC"/>
            <Setter Property="BorderThickness" Value="1,1,1,0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <!-- Global Menu Button Style -->
        <Style Selector="Button.global-menu">
            <Setter Property="Background" Value="#4472C4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="80"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="CornerRadius" Value="3"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"></Setter>
            <Setter Property="VerticalContentAlignment" Value="Center"></Setter>
        </Style>
        
        <Style Selector="Button.global-menu:pointerover">
            <Setter Property="Background" Value="#5B7BD5"/>
        </Style>

        <!-- Ribbon Group Style -->
        <Style Selector="Border.ribbon-group">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#D4D4D4"/>
            <Setter Property="BorderThickness" Value="0,0,1,0"/>
            <Setter Property="Padding" Value="8,5,8,5"/>
            <Setter Property="Margin" Value="0,0,5,0"/>
        </Style>

        <!-- Ribbon Button Styles -->
        <Style Selector="Button.ribbon-large">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="7,3"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="CornerRadius" Value="3"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <Style Selector="Button.ribbon-large:pointerover">
            <Setter Property="Background" Value="#E5F3FF"/>
            <Setter Property="BorderBrush" Value="#CCE4F7"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style Selector="Button.ribbon-small">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="5,2"/>
            <Setter Property="Margin" Value="1"/>
            <Setter Property="CornerRadius" Value="2"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="VerticalContentAlignment" Value="Center"></Setter>
        </Style>

        <Style Selector="Button.ribbon-small:pointerover">
            <Setter Property="Background" Value="#E5F3FF"/>
            <Setter Property="BorderBrush" Value="#CCE4F7"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </UserControl.Styles>

    <Grid>
        <Border Background="#F1F1F1" BorderBrush="#ACACAC" BorderThickness="0,0,0,1">
            <Grid RowDefinitions="Auto,Auto">
            <!-- Ribbon Tabs -->
            <Grid Grid.Row="0" Background="#E1E1E1" ColumnDefinitions="Auto,*">
                <!-- Global Menu Button -->
                <Button Grid.Column="0" Classes="global-menu" 
                        Content="æ–‡ä»¶" 
                        Click="GlobalMenuButton_Click"
                        Name="GlobalMenuButton"/>

                <!-- Tab Buttons -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Bottom" Margin="10,0,0,0">
                    <Button Classes="ribbon-tab active" Content="å¼€å§‹" Click="TabButton_Click" Tag="Home" Name="HomeTab"/>
                    <Button Classes="ribbon-tab" Content="å¸¸ç”¨å»ºæ¨¡" Click="TabButton_Click" Tag="Modeling" Name="ModelingTab"/>
                    <Button Classes="ribbon-tab" Content="åŠŸèƒ½æ¨¡åž‹" Click="TabButton_Click" Tag="Functions" Name="FunctionsTab"/>
                    <Button Classes="ribbon-tab" Content="è®¾è®¡æ¨¡åž‹" Click="TabButton_Click" Tag="Design" Name="DesignTab"/>
                    <Button Classes="ribbon-tab" Content="è™šå®žèžåˆè¯•éªŒéªŒè¯" Click="TabButton_Click" Tag="Testing" Name="TestingTab"/>
                    <Button Classes="ribbon-tab" Content="æ¨¡åž‹åº“" Click="TabButton_Click" Tag="Library" Name="LibraryTab"/>
                    <Button Classes="ribbon-tab" Content="å¹³å°ç®¡ç†" Click="TabButton_Click" Tag="Management" Name="ManagementTab"/>
                    <Button Classes="ribbon-tab" Content="å¸®åŠ©" Click="TabButton_Click" Tag="Help" Name="HelpTab"/>
                </StackPanel>
            </Grid>

            <!-- Ribbon Content Area -->
            <Border Grid.Row="1" Classes="ribbon-content" Background="White" BorderBrush="#ACACAC" BorderThickness="1,0,1,1" Height="100">
                <Grid>
                    <!-- Home Tab Content -->
                <ScrollViewer Name="HomeContent" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/undo.svg"/>
                                            <TextBlock Text="ä¸Šä¸€æ­¥" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/redo.svg"/>
                                            <TextBlock Text="ä¸‹ä¸€æ­¥" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="æ–‡ä»¶æ“ä½œ" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/new.svg"/>
                                            <TextBlock Text="æ–°å»º" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                             <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/open.svg"/>
                                            <TextBlock Text="æ‰“å¼€" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/save.svg"/>
                                            <TextBlock Text="ä¿å­˜" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/save-as.svg"/>
                                            <TextBlock Text="å¦å­˜ä¸º" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="æ–‡ä»¶æ“ä½œ" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/print.svg"/>
                                            <TextBlock Text="æ‰“å°" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/print-preview.svg"/>
                                            <TextBlock Text="æ‰“å°é¢„è§ˆ" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/exit.svg"/>
                                            <TextBlock Text="é€€å‡º" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="æ‰“å°" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <!-- Other Tab Contents (Hidden by default) -->
                <ScrollViewer Name="ModelingContent" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsVisible="False">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ”§" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="åŸºæœ¬æ¨¡åž‹" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <TextBlock Text="âš™ï¸" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="å¤åˆæ¨¡åž‹" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="å¸¸ç”¨å»ºæ¨¡" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <ScrollViewer Name="FunctionsContent" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsVisible="False">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70">
                                        <StackPanel>
                                            <TextBlock Text="ðŸŽ¯" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="åŠŸèƒ½å»ºæ¨¡" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="åŠŸèƒ½æ¨¡åž‹" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <ScrollViewer Name="DesignContent" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsVisible="False">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="è®¾è®¡å·¥å…·" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="è®¾è®¡æ¨¡åž‹" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <ScrollViewer Name="TestingContent" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsVisible="False">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ§ª" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="è¯•éªŒéªŒè¯" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="è™šå®žèžåˆè¯•éªŒéªŒè¯" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <ScrollViewer Name="LibraryContent" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsVisible="False">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“š" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="æ¨¡åž‹åº“" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="æ¨¡åž‹åº“" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <ScrollViewer Name="ManagementContent" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsVisible="False">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Height="70" Click="LogManagementButton_Click">
                                        <StackPanel>
                                            <svg:Svg Width="24" Height="24" HorizontalAlignment="Center" 
                                                     Path="avares://Sysware.UI/Assets/Icons/log.svg"/>
                                            <TextBlock Text="æ—¥å¿—ç®¡ç†" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <TextBlock Text="âš™ï¸" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="ç³»ç»Ÿè®¾ç½®" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ‘¥" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="ç”¨æˆ·ç®¡ç†" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Classes="ribbon-large" Height="70" Margin="5,0,0,0">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ”" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="æƒé™ç®¡ç†" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="å¹³å°ç®¡ç†" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <ScrollViewer Name="HelpContent" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsVisible="False">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Border Classes="ribbon-group">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Classes="ribbon-large" Command="{Binding AboutCommand}" Height="70">
                                        <StackPanel>
                                            <TextBlock Text="â“" FontSize="24" HorizontalAlignment="Center"/>
                                            <TextBlock Text="å…³äºŽ" FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="å¸®åŠ©" FontSize="11" HorizontalAlignment="Center" Foreground="#666666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
                </Grid>
            </Border>
        </Grid>
        </Border>

        <!-- Global Menu Popup -->
        <Popup Name="GlobalMenuPopup" IsLightDismissEnabled="True" PlacementTarget="{Binding ElementName=GlobalMenuButton}" Placement="BottomEdgeAlignedLeft">
            <Border Background="White" BorderBrush="#ACACAC" BorderThickness="1" CornerRadius="3" MinWidth="200">
                <StackPanel Margin="5">
                    <Button Content="æ–°å»º" Command="{Binding NewCommand}" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Margin="2"/>
                    <Button Content="æ‰“å¼€" Command="{Binding OpenCommand}" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Margin="2"/>
                    <Button Content="ä¿å­˜" Command="{Binding SaveCommand}" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Margin="2"/>
                    <Separator Margin="2"/>
                    <Button Content="é€‰é¡¹" Command="{Binding OptionsCommand}" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Margin="2"/>
                    <Separator Margin="2"/>
                    <Button Content="é€€å‡º" Command="{Binding ExitCommand}" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Margin="2"/>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>

</UserControl>
